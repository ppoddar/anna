<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Signup Hiraafood</title>
    

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  	
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../css/hiraafood.css">
  </head>

<body>

<script type="module">
  import Action         from '../../scripts/action.js'
  import Wizard         from '../../scripts/forms/wizard.js'
  import SignupFrom     from '../../scripts/forms/signup-form.js'
  import CommunicationForm   from '../../scripts/forms/communication-form.js'
  import AddressForm   from '../../scripts/forms/address-form.js'
  
    let wizard = new Wizard()
    wizard.addPage({title:'Sign up', form:new SignupFrom()})
    wizard.addPage({title:'Communication preference', form:new CommunicationForm()})
    wizard.addPage({title:'Set address', form:new AddressForm(), finish:true})
      
    wizard.onComplete = (input) => {
        console.log(input)
        let address = {
            line1: input.line1,
            line2: input.line2,
            city:  input.city,
            zip :  input.zip,
            tips:  input.tips
        }
        let deliveryAddress = Object.assign({kind:'home'}, address)
        let billingAddress  = Object.assign({kind:'billing'}, address)
        let user = {
            id:input.id,
            password: input.password,
            name: input.name,
            email: input.email,
            phone: input.phone,
            roles: ['customer'],
            addressses:{
                'delivery': address,
                'billing' : address
            }
        }
        Action.createUser(user, ()=> {
            window.location = 'login.html'
        })
    }
  
  wizard.open()
    
</script>

</body>
</html>